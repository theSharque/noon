server {
	listen 80;
	server_name mail.clixer.ru;
	root /var/www/roundcube;

	if ($http_host != "mail.clixer.ru") {
		rewrite ^ http://mail.clixer.ru$request_uri permanent;
	}

	index index.php index.html;

	location ~ ^/favicon.ico$ {
		root /var/www/roundcube/web/skins/default/images;
		log_not_found off;
		access_log off;
		expires max;
	}

	location = /robots.txt {
		allow all;
		log_not_found off;
		access_log off;
	}

	location ~ ^/(README|INSTALL|LICENSE|CHANGELOG|UPGRADING)$ {
		deny all;
	}

	location ~ ^/(bin|SQL)/ {
		deny all;
	}

	# Deny all attempts to access hidden files such as .htaccess, .htpasswd, .DS_Store (Mac).
	location ~ /\. {
		deny all;
		access_log off;
		log_not_found off;
	}

	location ~ \.php$ {
		include		fastcgi_params;
		try_files $uri =404;
		fastcgi_pass	unix:/var/run/php5-fpm.sock;
		fastcgi_index	index.php;
		fastcgi_intercept_errors on;
	}
}

server {
	listen			443;

	server_name mail.clixer.ru;
	root /var/www/roundcube;

	ssl			on;
	ssl_certificate		/etc/nginx/ssl/server.crt;
	ssl_certificate_key	/etc/nginx/ssl/server.key;

	add_header              Front-End-Https    on;

	if ($http_host != "mail.clixer.ru") {
		rewrite ^ http://mail.clixer.ru$request_uri permanent;
	}

	index index.php index.html;

	location ~ ^/favicon.ico$ {
		root /var/www/roundcube/web/skins/default/images;
		log_not_found off;
		access_log off;
		expires max;
	}

	location = /robots.txt {
		allow all;
		log_not_found off;
		access_log off;
	}

	location ~ ^/(README|INSTALL|LICENSE|CHANGELOG|UPGRADING)$ {
		deny all;
	}

	location ~ ^/(bin|SQL)/ {
		deny all;
	}

	# Deny all attempts to access hidden files such as .htaccess, .htpasswd, .DS_Store (Mac).
	location ~ /\. {
		deny all;
		access_log off;
		log_not_found off;
	}

	location ~ \.php$ {
		include		fastcgi_params;
		try_files $uri =404;
		fastcgi_pass	unix:/var/run/php5-fpm.sock;
		fastcgi_index	index.php;
		fastcgi_intercept_errors on;
	}
}
